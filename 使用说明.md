# 8bit音乐制作器 - 使用说明

## 测试和演示功能

### 1. 基础功能测试 (`test_basic.py`)

测试核心模块的基本功能，不播放音频，只验证代码逻辑。

```bash
python test_basic.py
```

**功能**：
- 测试波形生成器
- 测试包络处理器
- 测试音频引擎
- 测试序列器
- 测试项目模型

**输出**：显示测试结果，所有测试通过表示核心功能正常。

---

### 2. 快速音效演示 (`quick_demo.py`) ⭐推荐

快速生成并播放4个常用音效，适合快速体验。

```bash
python quick_demo.py
```

**会播放以下音效**：
1. **跳跃音效** - 快速上升的音调
2. **收集物品音效** - 上升的琶音（C-E-G和弦）
3. **爆炸音效** - 噪声 + 快速衰减
4. **UI点击音效** - 短促的方波

**特点**：
- 自动播放，无需交互
- 每个音效播放完成后自动播放下一个
- 适合快速体验8bit音效

---

### 3. 交互式音效演示 (`demo_sound_effects.py`) ⭐推荐

交互式试听和保存音效，功能最全。

```bash
python demo_sound_effects.py
```

**功能**：
- 交互式选择音效
- 实时播放试听
- 批量保存所有音效为WAV文件

**可用音效**：
1. **跳跃音效** - 快速上升的音调
2. **收集物品音效** - 上升的琶音
3. **爆炸音效** - 噪声 + 快速衰减
4. **射击音效** - 短促的方波脉冲
5. **UI点击音效** - 非常短促的方波
6. **错误音效** - 不和谐音程，下降音调
7. **强化道具音效** - 上升的音阶（C大调）

**使用方法**：
```
输入数字 1-7：播放对应的音效
输入 'save'：保存所有音效为WAV文件
输入 'q'：退出程序
```

**保存的文件**：
- `sound_effect_跳跃音效.wav`
- `sound_effect_收集物品音效.wav`
- `sound_effect_爆炸音效.wav`
- 等等...

---

## 音效说明

### 跳跃音效
- **特点**：快速上升的音高（C4 → E5）
- **波形**：方波
- **时长**：0.15秒
- **用途**：角色跳跃、弹跳等

### 收集物品音效
- **特点**：上升的琶音（C-E-G和弦）
- **波形**：方波
- **时长**：0.3秒
- **用途**：收集金币、道具等

### 爆炸音效
- **特点**：噪声 + 低频，快速衰减
- **波形**：白噪声 + 方波
- **时长**：0.4秒
- **用途**：爆炸、撞击等

### 射击音效
- **特点**：短促的方波脉冲
- **波形**：方波（25%占空比）
- **时长**：0.08秒
- **用途**：射击、发射等

### UI点击音效
- **特点**：非常短促的方波
- **波形**：方波
- **时长**：0.05秒
- **用途**：按钮点击、菜单选择等

### 错误音效
- **特点**：不和谐音程（C和C#同时播放），下降音调
- **波形**：方波
- **时长**：0.2秒
- **用途**：错误提示、失败等

### 强化道具音效
- **特点**：上升的音阶（C大调完整音阶）
- **波形**：方波
- **时长**：0.6秒
- **用途**：获得强化道具、升级等

---

## 使用技巧

### 1. 试听音效
运行 `demo_sound_effects.py`，输入数字试听不同音效。

### 2. 保存音效
运行 `demo_sound_effects.py`，输入 `save` 保存所有音效为WAV文件。

### 3. 修改音效
编辑 `demo_sound_effects.py` 中的音效生成函数，可以：
- 调整时长（duration）
- 修改频率（midi_note）
- 改变波形类型
- 调整包络参数（ADSR）

### 4. 创建自定义音效
参考现有音效函数，创建自己的音效：

```python
def generate_my_sound(self) -> np.ndarray:
    """生成我的自定义音效"""
    duration = 0.2
    freq = self.waveform_gen.midi_to_frequency(60)  # C4
    wave = self.waveform_gen.generate_square_wave(freq, duration, 1.0, 0.5)
    
    # 应用包络
    adsr = ADSRParams(attack=0.01, decay=0.05, sustain=0.7, release=0.14)
    envelope = self.envelope_proc.generate_adsr_envelope(duration, adsr)
    wave = wave * envelope
    
    return wave.astype(np.float32)
```

---

## 常见问题

### Q: 播放没有声音？
A: 检查系统音量，确保音频设备正常。如果使用远程连接，可能需要音频重定向。

### Q: 如何调整音效参数？
A: 编辑 `demo_sound_effects.py` 中对应的音效生成函数，修改：
- `duration`：时长
- `midi_note`：音高
- `ADSRParams`：包络参数
- `duty_cycle`：占空比（方波）

### Q: 如何保存单个音效？
A: 可以修改代码，或者运行 `demo_sound_effects.py` 后输入 `save` 保存所有音效。

### Q: 生成的WAV文件在哪里？
A: 保存在运行脚本的当前目录下，文件名格式：`sound_effect_音效名称.wav`

---

## 下一步

1. **使用主程序**：运行 `python main.py` 启动完整的音乐制作器
2. **学习音效制作**：参考 `demo_sound_effects.py` 学习如何制作音效
3. **阅读基础知识**：查看 `8bit音乐基础知识.md` 了解8bit音乐原理

---

## 技术细节

### 采样率
所有音效使用 44100 Hz 采样率（CD质量）。

### 音频格式
- 播放：16位立体声
- 保存：16位单声道/立体声 WAV文件

### 波形类型
主要使用方波，这是8bit音乐的标志性声音。

### 包络控制
使用ADSR包络控制音效的起音、衰减、延音和释音，让音效更自然。

---

享受制作8bit音效的乐趣！🎵🎮

